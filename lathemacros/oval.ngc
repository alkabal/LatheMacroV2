;Oval
O<oval> sub

#<_backup_metric> = #<_metric>
#<_backup_absolute> = #<_absolute>
#<_backup_feed> = #<_feed>
#<_backup_ccomp> = #<_ccomp>
#<_backup_tool_offset> = #<_tool_offset>
#<_backup_coord_system> = #<_coord_system>
#<_backup_ijk_abs_mode> = #<_ijk_absolute_mode>
o1 if [#<_ini[DISPLAY]LATHE>]
   #<_backup_lathe_diam_mode> = #<_lathe_diameter_mode>
   #<_backup_lathe_mode> = 1
o1 else
   #<_backup_lathe_mode> = 0
o1 endif

G8    ; Lathe radius Mode
G90   ; Absolute Distance
G91.1 ; but not for arcs

;;M6 T#10 G43
;        O100 if [#10 NE #<_current_tool>]
;                (MSG,ERROR : Change tool before use macro)
;                 o<restore> call     ; restore g20/21, g90/g91, feedrate cuter-comp and other using now global _backup_var
;        O100 return [-2] ; indicate failure to epilog
;        O100 endif

#1 = [#1 / 2] ; because of radius mode
#<starting_X> = [#<_x>] (starting X)
#<starting_Z> = #<_z> (starting Z)



;eoffset-per-angle.N.radius-ref float in (default: 1) Radius reference (see notes)
;eoffset-per-angle.N.angle float in (default: 0)Input angle (in degrees)

; var def number [${oval.x-f}] [${oval.sf-f}] [${oval.cut-f}] [${oval.feed-f}] [${oval.z-f}] [${oval.rfraction-f}] [${oval.start-ang-f}] [${oval.fnum-f}] [${oval.fmult-f}] [${oval.tool-s}]

G96 D2500 S#2 ; Constant Surface Speed Mode
M3 ;Start Spindle
G95 F#4 ; Feed-Per-Rev Mode
G4P1 ; Wait to reach speed




                (MSG,Oval TODO)



(DEBUG,oval finish rad #1 start rad #<starting_X> start length #<starting_Z> finish length #5)

O100 WHILE [#<starting_X> GT [#1 + #3 / 2]]
     G0 X #<starting_X>
     #<starting_X>=[#<starting_X>-#3 / 2]
     G1 X#<starting_X>
     G1 Z-#5 X#<starting_X>

     G1 X [#<starting_X> + #3]

     G0 Z[#<starting_Z>]
O100 ENDWHILE

G0 X#1
G1 Z-#5 X#1

     G1 X [#1 + #3]

G0 Z#<starting_Z>
G0 X#1 ; For touch-off







M5
M9

	o<restore> call     ; restore g20/21, g90/g91, feedrate cuter-comp and other using now global _backup_var

O<oval> endsub

M2
%
