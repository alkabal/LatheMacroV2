;Polygon
O<polygon> sub

#<_backup_metric> = #<_metric>
#<_backup_absolute> = #<_absolute>
#<_backup_feed> = #<_feed>
#<_backup_ccomp> = #<_ccomp>
#<_backup_tool_offset> = #<_tool_offset>
#<_backup_coord_system> = #<_coord_system>
#<_backup_ijk_abs_mode> = #<_ijk_absolute_mode>
o1 if [#<_ini[DISPLAY]LATHE>]
   #<_backup_lathe_diam_mode> = #<_lathe_diameter_mode>
   #<_backup_lathe_mode> = 1
o1 else
   #<_backup_lathe_mode> = 0
o1 endif

G8    ; Lathe radius Mode
G90   ; Absolute Distance
G91.1 ; but not for arcs

;M6 T#8 G43
        O100 if [#8 NE #<_current_tool>]
                (MSG,ERROR : Change tool before use macro)
                 o<restore> call     ; restore g20/21, g90/g91, feedrate cuter-comp and other using now global _backup_var
        O100 return [-2] ; indicate failure to epilog
        O100 endif

#1 = [#1 / 2] ; because of radius mode
#<starting_X> = [#<_x>] (startinG X)
#<starting_Z> = #<_z> (startinG Z)

; var def number [${polygon.inscradius-f}] [${polygon.numsides-s}] [${polygon.polyang-f}] [${polygon.cutterdiam-f}] [${polygon.toolang-f}] [${polygon.sf-f}] [${polygon.cut-f}] [${polygon.feed-f}] [${polygon.tool-s}]

M5
M9

	o<restore> call     ; restore g20/21, g90/g91, feedrate cuter-comp and other using now global _backup_var

O<polygon> endsub

M2
%
